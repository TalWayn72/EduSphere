enum AgentSessionStatus {
  ACTIVE
  COMPLETED
  FAILED
  CANCELLED
}

enum TemplateType {
  TUTOR
  QUIZ_GENERATOR
  DEBATE_FACILITATOR
  EXPLANATION_GENERATOR
  CHAVRUTA_DEBATE
  SUMMARIZE
  QUIZ_ASSESS
  RESEARCH_SCOUT
  EXPLAIN
  CUSTOM
}

type AgentSession @key(fields: "id") {
  id: ID!
  userId: ID!
  user: User!
  templateType: TemplateType!
  contextData: JSON
  status: AgentSessionStatus!
  messages: [AgentMessage!]!
  createdAt: String!
  completedAt: String
}

type User @key(fields: "id") {
  id: ID!
}

type Course @key(fields: "id") {
  id: ID!
}

scalar JSON

extend type Query {
  agentSession(id: ID!): AgentSession
  myAgentSessions: [AgentSession!]!
  agentTemplates: [AgentTemplate!]!
}

extend type Mutation {
  startAgentSession(templateType: TemplateType!, context: JSON!): AgentSession! @authenticated
  sendMessage(sessionId: ID!, content: String!): AgentMessage! @authenticated
  endSession(sessionId: ID!): Boolean! @authenticated
}

extend type Subscription {
  messageStream(sessionId: ID!): AgentMessage!
}
