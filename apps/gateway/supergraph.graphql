

    schema
    @link(url: "https://specs.apollo.dev/link/v1.0")
    @link(url: "https://specs.apollo.dev/join/v0.4", for: EXECUTION)
    
    
    
    
    
    @link(url: "https://specs.apollo.dev/authenticated/v0.1", for: SECURITY)
    
  {
    query: Query
    mutation: Mutation
    subscription: Subscription
  }

  
    directive @join__enumValue(graph: join__Graph!) repeatable on ENUM_VALUE

    directive @join__graph(name: String!, url: String!) on ENUM_VALUE

    
      directive @join__field(
        graph: join__Graph
        requires: join__FieldSet
        provides: join__FieldSet
        type: String
        external: Boolean
        override: String
        usedOverridden: Boolean
        overrideLabel: String
        
      ) repeatable on FIELD_DEFINITION | INPUT_FIELD_DEFINITION
    
    

    directive @join__implements(
      graph: join__Graph!
      interface: String!
    ) repeatable on OBJECT | INTERFACE

    directive @join__type(
      graph: join__Graph!
      key: join__FieldSet
      extension: Boolean! = false
      resolvable: Boolean! = true
      isInterfaceObject: Boolean! = false
    ) repeatable on OBJECT | INTERFACE | UNION | ENUM | INPUT_OBJECT | SCALAR

    directive @join__unionMember(
      graph: join__Graph!
      member: String!
    ) repeatable on UNION

    scalar join__FieldSet
    
  
  
  directive @link(
    url: String
    as: String
    for: link__Purpose
    import: [link__Import]
  ) repeatable on SCHEMA

  scalar link__Import

  enum link__Purpose {
    """
    `SECURITY` features provide metadata necessary to securely resolve fields.
    """
    SECURITY

    """
    `EXECUTION` features provide metadata necessary for operation execution.
    """
    EXECUTION
  }

  
  
  
  
  
  
  directive @authenticated on FIELD_DEFINITION | OBJECT | INTERFACE | SCALAR | ENUM

  
enum join__Graph {
  AGENT @join__graph(name: "agent", url: "http://localhost:4005/graphql") 
  ANNOTATION @join__graph(name: "annotation", url: "http://localhost:4003/graphql") 
  COLLABORATION @join__graph(name: "collaboration", url: "http://localhost:4004/graphql") 
  CONTENT @join__graph(name: "content", url: "http://localhost:4002/graphql") 
  CORE @join__graph(name: "core", url: "http://localhost:4001/graphql") 
  KNOWLEDGE @join__graph(name: "knowledge", url: "http://localhost:4006/graphql") 
}

scalar JSON @join__type(graph: AGENT)  @join__type(graph: ANNOTATION)  @join__type(graph: KNOWLEDGE) 

scalar DateTime @join__type(graph: ANNOTATION)  @join__type(graph: COLLABORATION)  @join__type(graph: CORE) 

type AgentMessage @join__type(graph: AGENT, key: "id")  {
  id: ID!
  sessionId: ID!
  session: AgentSession!
  role: MessageRole!
  content: String!
  createdAt: String!
}

type AgentSession @join__type(graph: AGENT, key: "id")  {
  id: ID!
  userId: ID!
  user: User!
  templateType: TemplateType!
  contextData: JSON
  status: AgentSessionStatus!
  messages: [AgentMessage!]!
  createdAt: String!
  completedAt: String
}

"""
External entity stubs
"""
type User @join__type(graph: AGENT, key: "id")  @join__type(graph: ANNOTATION, key: "id")  @join__type(graph: COLLABORATION, key: "id")  @join__type(graph: CONTENT, key: "id")  @join__type(graph: CORE, key: "id")  {
  id: ID!
  email: String! @join__field(graph: CORE) 
  firstName: String! @join__field(graph: CORE) 
  lastName: String! @join__field(graph: CORE) 
  role: UserRole! @join__field(graph: CORE) 
  tenantId: ID! @join__field(graph: CORE) 
  createdAt: DateTime! @join__field(graph: CORE) 
  updatedAt: DateTime! @join__field(graph: CORE) 
}

type Course @join__type(graph: AGENT, key: "id")  @join__type(graph: COLLABORATION, key: "id")  @join__type(graph: CONTENT, key: "id")  @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID! @join__field(graph: CONTENT) 
  title: String! @join__field(graph: CONTENT) 
  slug: String! @join__field(graph: CONTENT) 
  description: String @join__field(graph: CONTENT) 
  thumbnailUrl: String @join__field(graph: CONTENT) 
  instructorId: ID! @join__field(graph: CONTENT) 
  instructor: User @join__field(graph: CONTENT) 
  isPublished: Boolean! @join__field(graph: CONTENT) 
  estimatedHours: Int @join__field(graph: CONTENT) 
  modules: [Module!]! @join__field(graph: CONTENT) 
  createdAt: String! @join__field(graph: CONTENT) 
  updatedAt: String! @join__field(graph: CONTENT) 
}

type Query @join__type(graph: AGENT)  @join__type(graph: ANNOTATION)  @join__type(graph: COLLABORATION)  @join__type(graph: CONTENT)  @join__type(graph: CORE)  @join__type(graph: KNOWLEDGE)  {
  agentSession(id: ID!) : AgentSession @join__field(graph: AGENT) 
  myAgentSessions: [AgentSession!]! @join__field(graph: AGENT) 
  agentTemplates: [AgentTemplate!]! @join__field(graph: AGENT) 
  agentExecution(id: ID!) : AgentExecution @join__field(graph: AGENT) 
  agentExecutionsByUser(userId: ID!, limit: Int = 20) : [AgentExecution!]! @join__field(graph: AGENT) 
  agentExecutionsByAgent(agentId: ID!, limit: Int = 20) : [AgentExecution!]! @join__field(graph: AGENT) 
  runningExecutions(userId: ID!) : [AgentExecution!]! @join__field(graph: AGENT) 
  agentTemplate(id: ID!) : AgentTemplate @join__field(graph: AGENT) 
  agentTemplatesByType(template: String!) : [AgentTemplate!]! @join__field(graph: AGENT) 
  _health: String! @join__field(graph: ANNOTATION)  @join__field(graph: CONTENT)  @join__field(graph: CORE) 
  annotation(id: ID!) : Annotation @join__field(graph: ANNOTATION) 
  annotations(
    assetId: ID
    userId: ID
    layer: AnnotationLayer
    limit: Int = 20
    offset: Int = 0
  ): [Annotation!]! @join__field(graph: ANNOTATION) 
  annotationsByAsset(assetId: ID!, layer: AnnotationLayer) : [Annotation!]! @join__field(graph: ANNOTATION) 
  annotationsByUser(userId: ID!, limit: Int = 20, offset: Int = 0) : [Annotation!]! @join__field(graph: ANNOTATION) 
  """
  Get a single discussion by ID
  """
  discussion(id: ID!) : Discussion @join__field(graph: COLLABORATION)  @authenticated
  """
  Get all discussions for a course
  """
  discussions(courseId: ID!, limit: Int = 20, offset: Int = 0) : [Discussion!]! @join__field(graph: COLLABORATION)  @authenticated
  """
  Get all discussions the current user has participated in
  """
  myDiscussions(limit: Int = 20, offset: Int = 0) : [Discussion!]! @join__field(graph: COLLABORATION)  @authenticated
  """
  Get all messages in a discussion
  """
  discussionMessages(discussionId: ID!, limit: Int = 50, offset: Int = 0) : [DiscussionMessage!]! @join__field(graph: COLLABORATION)  @authenticated
  contentItem(id: ID!) : ContentItem @join__field(graph: CONTENT) 
  contentItemsByModule(moduleId: ID!) : [ContentItem!]! @join__field(graph: CONTENT) 
  course(id: ID!) : Course @join__field(graph: CONTENT) 
  courses(limit: Int = 20, offset: Int = 0) : [Course!]! @join__field(graph: CONTENT) 
  coursesByInstructor(instructorId: ID!, limit: Int = 20) : [Course!]! @join__field(graph: CONTENT) 
  myEnrollments: [UserCourse!]! @join__field(graph: CONTENT)  @authenticated
  myCourseProgress(courseId: ID!) : CourseProgress! @join__field(graph: CONTENT)  @authenticated
  getPresignedUploadUrl(fileName: String!, contentType: String!, courseId: ID!) : PresignedUploadUrl! @join__field(graph: CONTENT)  @authenticated
  module(id: ID!) : Module @join__field(graph: CONTENT) 
  modulesByCourse(courseId: ID!) : [Module!]! @join__field(graph: CONTENT) 
  tenant(id: ID!) : Tenant @join__field(graph: CORE) 
  tenants(limit: Int = 10, offset: Int = 0) : [Tenant!]! @join__field(graph: CORE) 
  user(id: ID!) : User @join__field(graph: CORE) 
  users(limit: Int = 10, offset: Int = 0) : [User!]! @join__field(graph: CORE) 
  me: User @join__field(graph: CORE)
  myStats: UserStats! @join__field(graph: CORE)  @authenticated
  adminOverview: AdminOverview! @join__field(graph: CORE)  @authenticated
  adminAnnouncements(limit: Int = 20, offset: Int = 0) : AnnouncementResult! @join__field(graph: CORE)  @authenticated
  activeAnnouncements: [Announcement!]! @join__field(graph: CORE)  @authenticated
  adminAuditLog(limit: Int = 50, offset: Int = 0, action: String, userId: ID, since: String, until: String) : AuditLogResult! @join__field(graph: CORE)  @authenticated
  roles: [Role!]! @join__field(graph: CORE)  @authenticated
  role(id: ID!) : Role @join__field(graph: CORE)  @authenticated
  userDelegations(userId: ID!) : [RoleDelegation!]! @join__field(graph: CORE)  @authenticated
  mySecuritySettings: SecuritySettings! @join__field(graph: CORE)  @authenticated
  adminUsers(limit: Int = 50, offset: Int = 0, search: String, role: UserRole) : AdminUsersResult! @join__field(graph: CORE)  @authenticated
  publicProfile(userId: ID!) : PublicProfile @join__field(graph: CORE)
  myTenantBranding: TenantBranding! @join__field(graph: CORE)  @authenticated
  myTenantLanguageSettings: TenantLanguageSettings! @join__field(graph: CORE)  @authenticated
  myBadges: [UserBadge!]! @join__field(graph: CORE)  @authenticated
  leaderboard(limit: Int) : [LeaderboardEntry!]! @join__field(graph: CORE)  @authenticated
  myRank: Int! @join__field(graph: CORE)  @authenticated
  myTotalPoints: Int! @join__field(graph: CORE)  @authenticated
  adminBadges: [Badge!]! @join__field(graph: CORE)  @authenticated
  myOpenBadges: [OpenBadgeAssertion!]! @join__field(graph: CORE)  @authenticated
  verifyOpenBadge(assertionId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  dueReviews(limit: Int) : [SRSCard!]! @join__field(graph: CORE)  @authenticated
  srsQueueCount: Int! @join__field(graph: CORE)  @authenticated
  scimTokens: [ScimToken!]! @join__field(graph: CORE)  @authenticated
  scimSyncLog(limit: Int) : [ScimSyncEntry!]! @join__field(graph: CORE)  @authenticated
  crmConnection: CrmConnection @join__field(graph: CORE)  @authenticated
  crmSyncLog(limit: Int) : [CrmSyncLogEntry!]! @join__field(graph: CORE)  @authenticated
  myPortal: PortalPage @join__field(graph: CORE)  @authenticated
  publicPortal: PortalPage @join__field(graph: CORE)
  myFollowers(limit: Int) : [ID!]! @join__field(graph: CORE)  @authenticated
  myFollowing(limit: Int) : [ID!]! @join__field(graph: CORE)  @authenticated
  embedding(id: ID!) : Embedding @join__field(graph: KNOWLEDGE)
  embeddingsByContentItem(contentItemId: ID!) : [Embedding!]! @join__field(graph: KNOWLEDGE) 
  semanticSearch(query: [Float!]!, limit: Int = 10, minSimilarity: Float = 0.7) : [SimilarityResult!]! @join__field(graph: KNOWLEDGE) 
  semanticSearchByContentItem(contentItemId: ID!, query: [Float!]!, limit: Int = 5) : [SimilarityResult!]! @join__field(graph: KNOWLEDGE) 
  concept(id: ID!) : Concept @join__field(graph: KNOWLEDGE) 
  conceptByName(name: String!) : Concept @join__field(graph: KNOWLEDGE) 
  concepts(limit: Int = 20) : [Concept!]! @join__field(graph: KNOWLEDGE) 
  relatedConcepts(conceptId: ID!, depth: Int = 2, limit: Int = 10) : [RelatedConcept!]! @join__field(graph: KNOWLEDGE) 
  person(id: ID!) : Person @join__field(graph: KNOWLEDGE) 
  personByName(name: String!) : Person @join__field(graph: KNOWLEDGE) 
  term(id: ID!) : Term @join__field(graph: KNOWLEDGE) 
  termByName(name: String!) : Term @join__field(graph: KNOWLEDGE) 
  source(id: ID!) : Source @join__field(graph: KNOWLEDGE) 
  topicCluster(id: ID!) : TopicCluster @join__field(graph: KNOWLEDGE) 
  topicClustersByCourse(courseId: ID!) : [TopicCluster!]! @join__field(graph: KNOWLEDGE) 
  searchSemantic(query: String!, limit: Int = 10) : [SemanticResult!]! @join__field(graph: KNOWLEDGE) 
  """
  Find the shortest learning path between two concepts identified by name.
  Returns null when no path exists between the two concepts.
  Uses Apache AGE shortestPath() traversing RELATED_TO and PREREQUISITE_OF edges.
  """
  learningPath(from: String!, to: String!) : LearningPath @join__field(graph: KNOWLEDGE)  @authenticated
  """
  Collect all distinct concepts reachable from a named concept within `depth` hops
  (default depth 2, max 5) via RELATED_TO edges using COLLECT(DISTINCT ...) aggregation.
  """
  relatedConceptsByName(conceptName: String!, depth: Int = 2) : [ConceptNode!]! @join__field(graph: KNOWLEDGE)  @authenticated
  """
  Find the deepest prerequisite chain leading into a named concept.
  Returns nodes ordered from root prerequisite to the target concept.
  """
  prerequisiteChain(conceptName: String!) : [ConceptNode!]! @join__field(graph: KNOWLEDGE)  @authenticated
}

type Mutation @join__type(graph: AGENT)  @join__type(graph: ANNOTATION)  @join__type(graph: COLLABORATION)  @join__type(graph: CONTENT)  @join__type(graph: CORE)  @join__type(graph: KNOWLEDGE)  {
  startAgentSession(templateType: TemplateType!, context: JSON!) : AgentSession! @join__field(graph: AGENT)  @authenticated
  sendMessage(sessionId: ID!, content: String!) : AgentMessage! @join__field(graph: AGENT)  @authenticated
  endSession(sessionId: ID!) : Boolean! @join__field(graph: AGENT)  @authenticated
  startAgentExecution(input: StartAgentExecutionInput!) : AgentExecution! @join__field(graph: AGENT)  @authenticated
  cancelAgentExecution(id: ID!) : AgentExecution! @join__field(graph: AGENT)  @authenticated
  createAgentTemplate(input: CreateAgentTemplateInput!) : AgentTemplate! @join__field(graph: AGENT)  @authenticated
  updateAgentTemplate(id: ID!, input: UpdateAgentTemplateInput!) : AgentTemplate! @join__field(graph: AGENT)  @authenticated
  deleteAgentTemplate(id: ID!) : Boolean! @join__field(graph: AGENT)  @authenticated
  activateAgentTemplate(id: ID!) : AgentTemplate! @join__field(graph: AGENT)  @authenticated
  deactivateAgentTemplate(id: ID!) : AgentTemplate! @join__field(graph: AGENT)  @authenticated
  createAnnotation(input: CreateAnnotationInput!) : Annotation! @join__field(graph: ANNOTATION)  @authenticated
  updateAnnotation(id: ID!, input: UpdateAnnotationInput!) : Annotation! @join__field(graph: ANNOTATION)  @authenticated
  deleteAnnotation(id: ID!) : Boolean! @join__field(graph: ANNOTATION)  @authenticated
  resolveAnnotation(id: ID!) : Annotation! @join__field(graph: ANNOTATION)  @authenticated
  replyToAnnotation(annotationId: ID!, content: String!) : Annotation! @join__field(graph: ANNOTATION)  @authenticated
  """
  Create a new discussion
  """
  createDiscussion(input: CreateDiscussionInput!) : Discussion! @join__field(graph: COLLABORATION)  @authenticated
  """
  Add a message to a discussion
  """
  addMessage(discussionId: ID!, input: AddMessageInput!) : DiscussionMessage! @join__field(graph: COLLABORATION)  @authenticated
  """
  Join a discussion as a participant
  """
  joinDiscussion(discussionId: ID!) : Boolean! @join__field(graph: COLLABORATION)  @authenticated
  """
  Leave a discussion
  """
  leaveDiscussion(discussionId: ID!) : Boolean! @join__field(graph: COLLABORATION)  @authenticated
  createCourse(input: CreateCourseInput!) : Course! @join__field(graph: CONTENT)  @authenticated
  updateCourse(id: ID!, input: UpdateCourseInput!) : Course! @join__field(graph: CONTENT)  @authenticated
  deleteCourse(id: ID!) : Boolean! @join__field(graph: CONTENT)  @authenticated
  publishCourse(id: ID!) : Course! @join__field(graph: CONTENT)  @authenticated
  unpublishCourse(id: ID!) : Course! @join__field(graph: CONTENT)  @authenticated
  enrollCourse(courseId: ID!) : UserCourse! @join__field(graph: CONTENT)  @authenticated
  unenrollCourse(courseId: ID!) : Boolean! @join__field(graph: CONTENT)  @authenticated
  markContentViewed(contentItemId: ID!) : Boolean! @join__field(graph: CONTENT)  @authenticated
  confirmMediaUpload(fileKey: String!, courseId: ID!, title: String!) : MediaAsset! @join__field(graph: CONTENT)  @authenticated
  createModule(input: CreateModuleInput!) : Module! @join__field(graph: CONTENT)  @authenticated
  updateModule(id: ID!, input: UpdateModuleInput!) : Module! @join__field(graph: CONTENT)  @authenticated
  deleteModule(id: ID!) : Boolean! @join__field(graph: CONTENT)  @authenticated
  reorderModules(courseId: ID!, moduleIds: [ID!]!) : [Module!]! @join__field(graph: CONTENT)  @authenticated
  createUser(input: CreateUserInput!) : User! @join__field(graph: CORE)  @authenticated
  updateUser(id: ID!, input: UpdateUserInput!) : User! @join__field(graph: CORE)  @authenticated
  createAnnouncement(input: CreateAnnouncementInput!) : Announcement! @join__field(graph: CORE)  @authenticated
  updateAnnouncement(id: ID!, input: UpdateAnnouncementInput!) : Announcement! @join__field(graph: CORE)  @authenticated
  deleteAnnouncement(id: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  publishAnnouncement(id: ID!) : Announcement! @join__field(graph: CORE)  @authenticated
  createRole(input: CreateRoleInput!) : Role! @join__field(graph: CORE)  @authenticated
  updateRole(id: ID!, input: UpdateRoleInput!) : Role! @join__field(graph: CORE)  @authenticated
  deleteRole(id: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  delegateRole(userId: ID!, roleId: ID!, validUntil: String) : RoleDelegation! @join__field(graph: CORE)  @authenticated
  revokeDelegation(delegationId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  updateSecuritySettings(input: UpdateSecuritySettingsInput!) : SecuritySettings! @join__field(graph: CORE)  @authenticated
  updateUserPreferences(input: UpdateUserPreferencesInput!) : User! @join__field(graph: CORE)  @authenticated
  updateProfileVisibility(isPublic: Boolean!) : UserPreferences! @join__field(graph: CORE)  @authenticated
  deactivateUser(id: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  resetUserPassword(userId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  bulkImportUsers(csvData: String!) : BulkImportResult! @join__field(graph: CORE)  @authenticated
  updateTenantBranding(input: UpdateTenantBrandingInput!) : TenantBranding! @join__field(graph: CORE)  @authenticated
  updateTenantLanguageSettings(input: UpdateTenantLanguageSettingsInput!) : TenantLanguageSettings! @join__field(graph: CORE)  @authenticated
  createBadge(input: CreateBadgeInput!) : Badge! @join__field(graph: CORE)  @authenticated
  updateBadge(id: ID!, input: UpdateBadgeInput!) : Badge! @join__field(graph: CORE)  @authenticated
  deleteBadge(id: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  issueBadge(badgeDefinitionId: ID!, recipientId: ID!, evidenceUrl: String) : OpenBadgeAssertion! @join__field(graph: CORE)  @authenticated
  revokeOpenBadge(assertionId: ID!, reason: String!) : Boolean! @join__field(graph: CORE)  @authenticated
  submitReview(cardId: ID!, quality: Int!) : SRSCard! @join__field(graph: CORE)  @authenticated
  createReviewCard(conceptName: String!) : SRSCard! @join__field(graph: CORE)  @authenticated
  generateScimToken(input: GenerateScimTokenInput!) : GenerateScimTokenResult! @join__field(graph: CORE)  @authenticated
  revokeScimToken(id: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  followUser(userId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  unfollowUser(userId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  disconnectCrm: Boolean! @join__field(graph: CORE)  @authenticated
  savePortalLayout(title: String!, blocksJson: String!) : PortalPage! @join__field(graph: CORE)  @authenticated
  publishPortal: Boolean! @join__field(graph: CORE)  @authenticated
  unpublishPortal: Boolean! @join__field(graph: CORE)  @authenticated
  exportAuditLog(fromDate: String!, toDate: String!, format: AuditExportFormat!) : AuditExportResult! @join__field(graph: CORE)  @authenticated
  scheduleGdprErasure(userId: ID!) : Boolean! @join__field(graph: CORE)  @authenticated
  createEmbedding(input: CreateEmbeddingInput!) : Embedding! @join__field(graph: KNOWLEDGE)  @authenticated
  deleteEmbedding(id: ID!) : Boolean! @join__field(graph: KNOWLEDGE)  @authenticated
  deleteEmbeddingsByContentItem(contentItemId: ID!) : Int! @join__field(graph: KNOWLEDGE)  @authenticated
  createConcept(input: CreateConceptInput!) : Concept! @join__field(graph: KNOWLEDGE)  @authenticated
  updateConcept(id: ID!, input: UpdateConceptInput!) : Concept! @join__field(graph: KNOWLEDGE)  @authenticated
  deleteConcept(id: ID!) : Boolean! @join__field(graph: KNOWLEDGE)  @authenticated
  linkConcepts(
    fromId: ID!
    toId: ID!
    relationshipType: String!
    strength: Float
    description: String
  ): ConceptRelationship! @join__field(graph: KNOWLEDGE)  @authenticated
  createPerson(input: CreatePersonInput!) : Person! @join__field(graph: KNOWLEDGE)  @authenticated
  createTerm(input: CreateTermInput!) : Term! @join__field(graph: KNOWLEDGE)  @authenticated
  createSource(input: CreateSourceInput!) : Source! @join__field(graph: KNOWLEDGE)  @authenticated
  createTopicCluster(input: CreateTopicClusterInput!) : TopicCluster! @join__field(graph: KNOWLEDGE)  @authenticated
  generateEmbedding(text: String!, entityType: String!, entityId: ID!) : Boolean! @join__field(graph: KNOWLEDGE)  @authenticated
}

type Subscription @join__type(graph: AGENT)  @join__type(graph: ANNOTATION)  @join__type(graph: COLLABORATION)  @join__type(graph: CORE)  {
  messageStream(sessionId: ID!) : AgentMessage! @join__field(graph: AGENT) 
  executionStatusChanged(executionId: ID!) : AgentExecution! @join__field(graph: AGENT) 
  """
  Subscribe to new annotations on a specific asset in real-time
  """
  annotationAdded(assetId: ID!) : Annotation! @join__field(graph: ANNOTATION) 
  """
  Subscribe to new messages in a discussion
  """
  messageAdded(discussionId: ID!) : DiscussionMessage! @join__field(graph: COLLABORATION) 
  """
  User created event
  """
  userCreated(tenantId: ID!) : User! @join__field(graph: CORE) 
  """
  User updated event
  """
  userUpdated(userId: ID!, tenantId: ID!) : User! @join__field(graph: CORE) 
  """
  Real-time user status updates
  """
  userStatusChanged(userId: ID!) : UserStatus! @join__field(graph: CORE) 
}

type AgentExecution @join__type(graph: AGENT, key: "id")  {
  id: ID!
  agentId: ID!
  agent: AgentTemplate!
  userId: ID!
  user: User!
  input: JSON!
  output: JSON
  status: AgentExecutionStatus!
  startedAt: String
  completedAt: String
  metadata: JSON!
}

type AgentTemplate @join__type(graph: AGENT, key: "id")  {
  id: ID!
  name: String!
  templateType: TemplateType!
  systemPrompt: String!
  parameters: JSON!
}

type Annotation @join__type(graph: ANNOTATION, key: "id")  {
  id: ID!
  tenantId: ID!
  assetId: ID!
  userId: ID!
  user: User
  annotationType: AnnotationType!
  layer: AnnotationLayer!
  content: JSON!
  spatialData: JSON
  parentId: ID
  parent: Annotation
  isResolved: Boolean!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type ContentItem @join__type(graph: ANNOTATION, key: "id")  @join__type(graph: CONTENT, key: "id")  @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  moduleId: ID! @join__field(graph: CONTENT) 
  title: String! @join__field(graph: CONTENT) 
  contentType: String! @join__field(graph: CONTENT) 
  content: String @join__field(graph: CONTENT) 
  fileId: ID @join__field(graph: CONTENT) 
  duration: Int @join__field(graph: CONTENT) 
  orderIndex: Int! @join__field(graph: CONTENT) 
  createdAt: String! @join__field(graph: CONTENT) 
  updatedAt: String! @join__field(graph: CONTENT) 
}

"""
Discussion in a course
"""
type Discussion @join__type(graph: COLLABORATION, key: "id")  {
  id: ID!
  courseId: ID!
  course: Course!
  title: String!
  description: String
  creatorId: ID!
  creator: User!
  discussionType: DiscussionType!
  messages(limit: Int = 50, offset: Int = 0) : [DiscussionMessage!]!
  participants: [DiscussionParticipant!]!
  participantCount: Int!
  messageCount: Int!
  createdAt: DateTime!
  updatedAt: DateTime!
}

"""
Message in a discussion
"""
type DiscussionMessage @join__type(graph: COLLABORATION, key: "id")  {
  id: ID!
  discussionId: ID!
  discussion: Discussion!
  userId: ID!
  user: User!
  content: String!
  messageType: MessageType!
  parentMessageId: ID
  parentMessage: DiscussionMessage
  replies(limit: Int = 20, offset: Int = 0) : [DiscussionMessage!]!
  replyCount: Int!
  createdAt: DateTime!
  updatedAt: DateTime!
}

"""
Participant in a discussion
"""
type DiscussionParticipant @join__type(graph: COLLABORATION)  {
  id: ID!
  discussionId: ID!
  discussion: Discussion!
  userId: ID!
  user: User!
  joinedAt: DateTime!
}

type UserCourse @join__type(graph: CONTENT)  {
  id: ID!
  courseId: ID!
  userId: ID!
  status: String!
  enrolledAt: String!
  completedAt: String
}

type CourseProgress @join__type(graph: CONTENT)  {
  courseId: ID!
  totalItems: Int!
  completedItems: Int!
  percentComplete: Float!
}

type PresignedUploadUrl @join__type(graph: CONTENT)  {
  uploadUrl: String!
  fileKey: String!
  expiresAt: String!
}

type MediaAsset @join__type(graph: CONTENT)  {
  id: ID!
  courseId: ID!
  fileKey: String!
  title: String!
  contentType: String!
  status: MediaStatus!
  downloadUrl: String
  """
  Presigned URL for the HLS master manifest (.m3u8).
  Null until HLS transcoding completes (non-blocking background step).
  Valid for 1 hour after generation.
  """
  hlsManifestUrl: String
}

type Module @join__type(graph: CONTENT, key: "id")  {
  id: ID!
  courseId: ID!
  course: Course!
  title: String!
  description: String
  orderIndex: Int!
  contentItems: [ContentItem!]!
  createdAt: String!
}

type Tenant @join__type(graph: CORE, key: "id")  {
  id: ID!
  name: String!
  slug: String!
  plan: TenantPlan!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type UserStats @join__type(graph: CORE)  {
  coursesEnrolled: Int!
  annotationsCreated: Int!
  conceptsMastered: Int!
  totalLearningMinutes: Int!
  weeklyActivity: [DayActivity!]!
}

type DayActivity @join__type(graph: CORE)  {
  date: String!
  count: Int!
}

type UserStatus @join__type(graph: CORE)  {
  userId: ID!
  online: Boolean!
  lastSeen: DateTime!
}

type AdminOverview @join__type(graph: CORE)  {
  totalUsers: Int! @join__field(graph: CORE)
  activeUsersThisMonth: Int! @join__field(graph: CORE)
  totalCourses: Int! @join__field(graph: CORE)
  completionsThisMonth: Int! @join__field(graph: CORE)
  atRiskCount: Int! @join__field(graph: CORE)
  lastScimSync: String @join__field(graph: CORE)
  lastComplianceReport: String @join__field(graph: CORE)
  storageUsedMb: Float! @join__field(graph: CORE)
}

type Announcement @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  title: String! @join__field(graph: CORE)
  body: String! @join__field(graph: CORE)
  priority: String! @join__field(graph: CORE)
  targetAudience: String! @join__field(graph: CORE)
  isActive: Boolean! @join__field(graph: CORE)
  publishAt: String @join__field(graph: CORE)
  expiresAt: String @join__field(graph: CORE)
  createdBy: ID @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
}

type AnnouncementResult @join__type(graph: CORE)  {
  announcements: [Announcement!]! @join__field(graph: CORE)
  total: Int! @join__field(graph: CORE)
}

type AuditLogEntry @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  tenantId: ID! @join__field(graph: CORE)
  userId: ID @join__field(graph: CORE)
  action: String! @join__field(graph: CORE)
  resourceType: String @join__field(graph: CORE)
  resourceId: ID @join__field(graph: CORE)
  status: String! @join__field(graph: CORE)
  ipAddress: String @join__field(graph: CORE)
  requestId: String @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
  metadata: String @join__field(graph: CORE)
}

type AuditLogResult @join__type(graph: CORE)  {
  entries: [AuditLogEntry!]! @join__field(graph: CORE)
  total: Int! @join__field(graph: CORE)
}

type Role @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  tenantId: ID! @join__field(graph: CORE)
  name: String! @join__field(graph: CORE)
  description: String! @join__field(graph: CORE)
  permissions: [String!]! @join__field(graph: CORE)
  isSystem: Boolean! @join__field(graph: CORE)
  userCount: Int! @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
  updatedAt: String! @join__field(graph: CORE)
}

type RoleDelegation @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  userId: ID! @join__field(graph: CORE)
  roleId: ID! @join__field(graph: CORE)
  delegatedBy: ID! @join__field(graph: CORE)
  validUntil: String @join__field(graph: CORE)
  isActive: Boolean! @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
}

type SecuritySettings @join__type(graph: CORE)  {
  mfaRequired: Boolean! @join__field(graph: CORE)
  mfaRequiredForAdmins: Boolean! @join__field(graph: CORE)
  sessionTimeoutMinutes: Int! @join__field(graph: CORE)
  maxConcurrentSessions: Int! @join__field(graph: CORE)
  loginAttemptLockoutThreshold: Int! @join__field(graph: CORE)
  passwordMinLength: Int! @join__field(graph: CORE)
  passwordRequireSpecialChars: Boolean! @join__field(graph: CORE)
  passwordExpiryDays: Int @join__field(graph: CORE)
  ipAllowlist: [String!]! @join__field(graph: CORE)
}

type Embedding @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  contentItemId: ID!
  contentItem: ContentItem!
  chunkText: String!
  embedding: [Float!]!
  metadata: JSON
  createdAt: String!
}

type SimilarityResult @join__type(graph: KNOWLEDGE)  {
  embedding: Embedding!
  similarity: Float!
  distance: Float!
}

type Concept @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID!
  name: String!
  definition: String!
  sourceIds: [ID!]!
  createdAt: String!
  updatedAt: String!
}

type Person @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID!
  name: String!
  bio: String
  createdAt: String!
  updatedAt: String!
}

type Term @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID!
  name: String!
  definition: String!
  createdAt: String!
  updatedAt: String!
}

type Source @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID!
  title: String!
  type: String!
  url: String
  createdAt: String!
  updatedAt: String!
}

type TopicCluster @join__type(graph: KNOWLEDGE, key: "id")  {
  id: ID!
  tenantId: ID!
  name: String!
  description: String
  createdAt: String!
  updatedAt: String!
}

type ConceptRelationship @join__type(graph: KNOWLEDGE)  {
  fromConcept: Concept!
  toConcept: Concept!
  relationshipType: String!
  strength: Float
  inferred: Boolean
  description: String
}

type RelatedConcept @join__type(graph: KNOWLEDGE)  {
  concept: Concept!
  strength: Float!
}

type SemanticResult @join__type(graph: KNOWLEDGE)  {
  id: ID!
  text: String!
  similarity: Float!
  entityType: String!
  entityId: ID!
}

"""
A lightweight concept node used in learning path and prerequisite chain results.
Distinct from the full Concept entity — carries only the fields needed for path display.
"""
type ConceptNode @join__type(graph: KNOWLEDGE)  {
  id: ID!
  name: String!
  type: String
}

"""
Result of a shortestPath query between two concepts.
concepts: ordered list of ConceptNodes along the path (start inclusive, end inclusive).
steps: number of edges in the path (= length of path).
"""
type LearningPath @join__type(graph: KNOWLEDGE)  {
  concepts: [ConceptNode!]!
  steps: Int!
}

enum MessageRole @join__type(graph: AGENT)  {
  USER @join__enumValue(graph: AGENT) 
  ASSISTANT @join__enumValue(graph: AGENT) 
  SYSTEM @join__enumValue(graph: AGENT) 
  TOOL @join__enumValue(graph: AGENT) 
}

enum TemplateType @join__type(graph: AGENT)  {
  TUTOR @join__enumValue(graph: AGENT) 
  QUIZ_GENERATOR @join__enumValue(graph: AGENT) 
  DEBATE_FACILITATOR @join__enumValue(graph: AGENT) 
  EXPLANATION_GENERATOR @join__enumValue(graph: AGENT) 
  CHAVRUTA_DEBATE @join__enumValue(graph: AGENT) 
  SUMMARIZE @join__enumValue(graph: AGENT) 
  QUIZ_ASSESS @join__enumValue(graph: AGENT) 
  RESEARCH_SCOUT @join__enumValue(graph: AGENT) 
  EXPLAIN @join__enumValue(graph: AGENT) 
  CUSTOM @join__enumValue(graph: AGENT) 
}

enum AgentSessionStatus @join__type(graph: AGENT)  {
  ACTIVE @join__enumValue(graph: AGENT) 
  COMPLETED @join__enumValue(graph: AGENT) 
  FAILED @join__enumValue(graph: AGENT) 
  CANCELLED @join__enumValue(graph: AGENT) 
}

enum AgentExecutionStatus @join__type(graph: AGENT)  {
  QUEUED @join__enumValue(graph: AGENT) 
  RUNNING @join__enumValue(graph: AGENT) 
  COMPLETED @join__enumValue(graph: AGENT) 
  FAILED @join__enumValue(graph: AGENT) 
  CANCELLED @join__enumValue(graph: AGENT) 
}

enum AnnotationType @join__type(graph: ANNOTATION)  {
  TEXT @join__enumValue(graph: ANNOTATION) 
  SKETCH @join__enumValue(graph: ANNOTATION) 
  LINK @join__enumValue(graph: ANNOTATION) 
  BOOKMARK @join__enumValue(graph: ANNOTATION) 
  SPATIAL_COMMENT @join__enumValue(graph: ANNOTATION) 
}

enum AnnotationLayer @join__type(graph: ANNOTATION)  {
  PERSONAL @join__enumValue(graph: ANNOTATION) 
  SHARED @join__enumValue(graph: ANNOTATION) 
  INSTRUCTOR @join__enumValue(graph: ANNOTATION) 
  AI_GENERATED @join__enumValue(graph: ANNOTATION) 
}

"""
Discussion types
"""
enum DiscussionType @join__type(graph: COLLABORATION)  {
  FORUM @join__enumValue(graph: COLLABORATION) 
  CHAVRUTA @join__enumValue(graph: COLLABORATION) 
  DEBATE @join__enumValue(graph: COLLABORATION) 
}

"""
Message types
"""
enum MessageType @join__type(graph: COLLABORATION)  {
  TEXT @join__enumValue(graph: COLLABORATION) 
  IMAGE @join__enumValue(graph: COLLABORATION) 
  VIDEO @join__enumValue(graph: COLLABORATION) 
  AUDIO @join__enumValue(graph: COLLABORATION) 
}

enum MediaStatus @join__type(graph: CONTENT)  {
  UPLOADING @join__enumValue(graph: CONTENT) 
  PROCESSING @join__enumValue(graph: CONTENT) 
  READY @join__enumValue(graph: CONTENT) 
  ERROR @join__enumValue(graph: CONTENT) 
}

enum TenantPlan @join__type(graph: CORE)  {
  FREE @join__enumValue(graph: CORE) 
  STARTER @join__enumValue(graph: CORE) 
  PROFESSIONAL @join__enumValue(graph: CORE) 
  ENTERPRISE @join__enumValue(graph: CORE) 
}

enum UserRole @join__type(graph: CORE)  {
  SUPER_ADMIN @join__enumValue(graph: CORE) 
  ORG_ADMIN @join__enumValue(graph: CORE) 
  INSTRUCTOR @join__enumValue(graph: CORE) 
  STUDENT @join__enumValue(graph: CORE) 
  RESEARCHER @join__enumValue(graph: CORE) 
}

input StartAgentExecutionInput @join__type(graph: AGENT)  {
  agentId: ID!
  userId: ID!
  input: JSON!
  metadata: JSON
}

input CreateAgentTemplateInput @join__type(graph: AGENT)  {
  name: String!
  templateType: TemplateType!
  systemPrompt: String!
  parameters: JSON
}

input UpdateAgentTemplateInput @join__type(graph: AGENT)  {
  name: String
  systemPrompt: String
  parameters: JSON
}

input CreateAnnotationInput @join__type(graph: ANNOTATION)  {
  assetId: ID!
  annotationType: AnnotationType!
  layer: AnnotationLayer = PERSONAL
  content: JSON!
  spatialData: JSON
  parentId: ID
}

input UpdateAnnotationInput @join__type(graph: ANNOTATION)  {
  content: JSON
  spatialData: JSON
  isResolved: Boolean
}

input CreateDiscussionInput @join__type(graph: COLLABORATION)  {
  courseId: ID!
  title: String!
  description: String
  discussionType: DiscussionType!
}

input AddMessageInput @join__type(graph: COLLABORATION)  {
  content: String!
  messageType: MessageType!
  parentMessageId: ID
}

input CreateCourseInput @join__type(graph: CONTENT)  {
  title: String!
  slug: String!
  description: String
  instructorId: ID!
  thumbnailUrl: String
  estimatedHours: Int
  isPublished: Boolean
}

input UpdateCourseInput @join__type(graph: CONTENT)  {
  title: String
  slug: String
  description: String
  thumbnailUrl: String
  estimatedHours: Int
}

input CreateModuleInput @join__type(graph: CONTENT)  {
  courseId: ID!
  title: String!
  description: String
  orderIndex: Int!
}

input UpdateModuleInput @join__type(graph: CONTENT)  {
  title: String
  description: String
  orderIndex: Int
}

input CreateUserInput @join__type(graph: CORE)  {
  email: String!
  firstName: String!
  lastName: String!
  role: UserRole!
  tenantId: ID!
}

input UpdateUserInput @join__type(graph: CORE)  {
  firstName: String
  lastName: String
  role: UserRole
}

input CreateAnnouncementInput @join__type(graph: CORE)  {
  title: String!
  body: String!
  priority: String!
  targetAudience: String!
  publishAt: String
  expiresAt: String
}

input UpdateAnnouncementInput @join__type(graph: CORE)  {
  title: String
  body: String
  priority: String
  targetAudience: String
  isActive: Boolean
  publishAt: String
  expiresAt: String
}

input CreateRoleInput @join__type(graph: CORE)  {
  name: String!
  description: String
  permissions: [String!]!
}

input UpdateRoleInput @join__type(graph: CORE)  {
  name: String
  description: String
  permissions: [String!]
}

input UpdateSecuritySettingsInput @join__type(graph: CORE)  {
  mfaRequired: Boolean
  mfaRequiredForAdmins: Boolean
  sessionTimeoutMinutes: Int
  maxConcurrentSessions: Int
  loginAttemptLockoutThreshold: Int
  passwordMinLength: Int
  passwordRequireSpecialChars: Boolean
  passwordExpiryDays: Int
  ipAllowlist: [String!]
}

input CreateEmbeddingInput @join__type(graph: KNOWLEDGE)  {
  contentItemId: ID!
  chunkText: String!
  embedding: [Float!]!
  metadata: JSON
}

input CreateConceptInput @join__type(graph: KNOWLEDGE)  {
  name: String!
  definition: String!
  sourceIds: [ID!]
}

input UpdateConceptInput @join__type(graph: KNOWLEDGE)  {
  name: String
  definition: String
  sourceIds: [ID!]
}

input CreatePersonInput @join__type(graph: KNOWLEDGE)  {
  name: String!
  bio: String
}

input CreateTermInput @join__type(graph: KNOWLEDGE)  {
  name: String!
  definition: String!
}

input CreateSourceInput @join__type(graph: KNOWLEDGE)  {
  title: String!
  type: String!
  url: String
}

input CreateTopicClusterInput @join__type(graph: KNOWLEDGE)  {
  name: String!
  description: String
}

# ── User extended types (user.graphql) ────────────────────────────────────────

type UserPreferences @join__type(graph: CORE)  {
  locale: String! @join__field(graph: CORE)
  theme: String! @join__field(graph: CORE)
  emailNotifications: Boolean! @join__field(graph: CORE)
  pushNotifications: Boolean! @join__field(graph: CORE)
  isPublicProfile: Boolean! @join__field(graph: CORE)
}

type PublicCourse @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  title: String! @join__field(graph: CORE)
  completedAt: DateTime! @join__field(graph: CORE)
}

type PublicProfile @join__type(graph: CORE)  {
  userId: ID! @join__field(graph: CORE)
  displayName: String! @join__field(graph: CORE)
  bio: String @join__field(graph: CORE)
  avatarUrl: String @join__field(graph: CORE)
  joinedAt: DateTime! @join__field(graph: CORE)
  currentStreak: Int! @join__field(graph: CORE)
  longestStreak: Int! @join__field(graph: CORE)
  completedCoursesCount: Int! @join__field(graph: CORE)
  completedCourses: [PublicCourse!]! @join__field(graph: CORE)
  badgesCount: Int! @join__field(graph: CORE)
  conceptsMastered: Int! @join__field(graph: CORE)
  totalLearningMinutes: Int! @join__field(graph: CORE)
}

type BulkImportResult @join__type(graph: CORE)  {
  created: Int! @join__field(graph: CORE)
  updated: Int! @join__field(graph: CORE)
  failed: Int! @join__field(graph: CORE)
  errors: [String!]! @join__field(graph: CORE)
}

type AdminUsersResult @join__type(graph: CORE)  {
  users: [User!]! @join__field(graph: CORE)
  total: Int! @join__field(graph: CORE)
}

input UpdateUserPreferencesInput @join__type(graph: CORE)  {
  locale: String
  theme: String
  emailNotifications: Boolean
  pushNotifications: Boolean
}

# ── Gamification + Open Badges 3.0 (gamification.graphql) ────────────────────

type Badge @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  name: String! @join__field(graph: CORE)
  description: String! @join__field(graph: CORE)
  iconEmoji: String! @join__field(graph: CORE)
  category: String! @join__field(graph: CORE)
  pointsReward: Int! @join__field(graph: CORE)
  conditionType: String! @join__field(graph: CORE)
  conditionValue: Int! @join__field(graph: CORE)
}

type UserBadge @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  badge: Badge! @join__field(graph: CORE)
  earnedAt: DateTime! @join__field(graph: CORE)
}

type LeaderboardEntry @join__type(graph: CORE)  {
  rank: Int! @join__field(graph: CORE)
  userId: ID! @join__field(graph: CORE)
  displayName: String! @join__field(graph: CORE)
  totalPoints: Int! @join__field(graph: CORE)
  badgeCount: Int! @join__field(graph: CORE)
}

type OpenBadgeDefinition @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  name: String! @join__field(graph: CORE)
  description: String! @join__field(graph: CORE)
  imageUrl: String @join__field(graph: CORE)
  criteriaUrl: String @join__field(graph: CORE)
  tags: [String!]! @join__field(graph: CORE)
  issuerId: String! @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
}

type OpenBadgeAssertion @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  badgeDefinitionId: ID! @join__field(graph: CORE)
  recipientId: ID! @join__field(graph: CORE)
  issuedAt: String! @join__field(graph: CORE)
  expiresAt: String @join__field(graph: CORE)
  evidenceUrl: String @join__field(graph: CORE)
  revoked: Boolean! @join__field(graph: CORE)
  revokedAt: String @join__field(graph: CORE)
  revokedReason: String @join__field(graph: CORE)
  definition: OpenBadgeDefinition! @join__field(graph: CORE)
  vcDocument: String! @join__field(graph: CORE)
}

input CreateBadgeInput @join__type(graph: CORE)  {
  name: String!
  description: String!
  iconEmoji: String!
  category: String!
  pointsReward: Int!
  conditionType: String!
  conditionValue: Int!
}

input UpdateBadgeInput @join__type(graph: CORE)  {
  name: String
  description: String
  iconEmoji: String
  category: String
  pointsReward: Int
  conditionType: String
  conditionValue: Int
}

# ── SRS / Spaced-Repetition (srs.graphql) ─────────────────────────────────────

type SRSCard @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  conceptName: String! @join__field(graph: CORE)
  dueDate: DateTime! @join__field(graph: CORE)
  intervalDays: Int! @join__field(graph: CORE)
  easeFactor: Float! @join__field(graph: CORE)
  repetitions: Int! @join__field(graph: CORE)
  lastReviewedAt: DateTime @join__field(graph: CORE)
}

# ── Tenant branding & language (tenant.graphql) ───────────────────────────────

type TenantLanguageSettings @join__type(graph: CORE)  {
  supportedLanguages: [String!]! @join__field(graph: CORE)
  defaultLanguage: String! @join__field(graph: CORE)
}

type TenantBranding @join__type(graph: CORE)  {
  logoUrl: String! @join__field(graph: CORE)
  logoMarkUrl: String @join__field(graph: CORE)
  faviconUrl: String! @join__field(graph: CORE)
  primaryColor: String! @join__field(graph: CORE)
  secondaryColor: String! @join__field(graph: CORE)
  accentColor: String! @join__field(graph: CORE)
  backgroundColor: String! @join__field(graph: CORE)
  fontFamily: String! @join__field(graph: CORE)
  organizationName: String! @join__field(graph: CORE)
  tagline: String @join__field(graph: CORE)
  privacyPolicyUrl: String @join__field(graph: CORE)
  termsOfServiceUrl: String @join__field(graph: CORE)
  supportEmail: String @join__field(graph: CORE)
  hideEduSphereBranding: Boolean! @join__field(graph: CORE)
}

input UpdateTenantBrandingInput @join__type(graph: CORE)  {
  logoUrl: String
  logoMarkUrl: String
  faviconUrl: String
  primaryColor: String
  secondaryColor: String
  accentColor: String
  backgroundColor: String
  fontFamily: String
  organizationName: String
  tagline: String
  privacyPolicyUrl: String
  termsOfServiceUrl: String
  supportEmail: String
  hideEduSphereBranding: Boolean
}

input UpdateTenantLanguageSettingsInput @join__type(graph: CORE)  {
  supportedLanguages: [String!]!
  defaultLanguage: String!
}

# ── SCIM provisioning (scim.graphql) ─────────────────────────────────────────

type ScimToken @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  description: String! @join__field(graph: CORE)
  lastUsedAt: DateTime @join__field(graph: CORE)
  expiresAt: DateTime @join__field(graph: CORE)
  isActive: Boolean! @join__field(graph: CORE)
  createdAt: DateTime! @join__field(graph: CORE)
}

type ScimSyncEntry @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  operation: String! @join__field(graph: CORE)
  externalId: String @join__field(graph: CORE)
  status: String! @join__field(graph: CORE)
  errorMessage: String @join__field(graph: CORE)
  createdAt: DateTime! @join__field(graph: CORE)
}

type GenerateScimTokenResult @join__type(graph: CORE)  {
  token: ScimToken! @join__field(graph: CORE)
  rawToken: String! @join__field(graph: CORE)
}

input GenerateScimTokenInput @join__type(graph: CORE)  {
  description: String!
  expiresInDays: Int
}

# ── CRM integration (crm.graphql) ─────────────────────────────────────────────

type CrmConnection @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  provider: String! @join__field(graph: CORE)
  instanceUrl: String! @join__field(graph: CORE)
  isActive: Boolean! @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
}

type CrmSyncLogEntry @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  operation: String! @join__field(graph: CORE)
  externalId: String @join__field(graph: CORE)
  status: String! @join__field(graph: CORE)
  errorMessage: String @join__field(graph: CORE)
  createdAt: String! @join__field(graph: CORE)
}

# ── Portal builder (portal.graphql) ───────────────────────────────────────────

type PortalBlock @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  type: String! @join__field(graph: CORE)
  order: Int! @join__field(graph: CORE)
  config: String! @join__field(graph: CORE)
}

type PortalPage @join__type(graph: CORE)  {
  id: ID! @join__field(graph: CORE)
  title: String! @join__field(graph: CORE)
  published: Boolean! @join__field(graph: CORE)
  blocks: [PortalBlock!]! @join__field(graph: CORE)
  updatedAt: String! @join__field(graph: CORE)
}

# ── Audit export (audit.graphql) ──────────────────────────────────────────────

enum AuditExportFormat @join__type(graph: CORE)  {
  CSV @join__enumValue(graph: CORE)
  JSON @join__enumValue(graph: CORE)
}

type AuditExportResult @join__type(graph: CORE)  {
  presignedUrl: String! @join__field(graph: CORE)
  expiresAt: String! @join__field(graph: CORE)
  recordCount: Int! @join__field(graph: CORE)
}
